#!/bin/bash -e

# -------------------------------------------------------------------------------------------------
# Functions
# -------------------------------------------------------------------------------------------------
BASEDIR=$(dirname $(readlink -f ${0}))
source "${BASEDIR}/util.sh"

function usage {
  echo "Print contents of file from stage"
  echo "Usage: ${0} <path to file>"
  exit 0
}

# -------------------------------------------------------------------------------------------------
# Parse Arg
# -------------------------------------------------------------------------------------------------
if [[ ${#} -eq 1 && ("${1}" == "-h" || "${1}" == "--help") ]]
then
  usage
fi

if [[ ${#} -ne 1 ]]
then
  dieUsage "Incorrect argument count ${#}"
fi

pathToFile="${1}"

# -------------------------------------------------------------------------------------------------
# Main
# -------------------------------------------------------------------------------------------------

# Create a bash array from the list of stage files
arr_file=($(git-ls-stage-files))

# Exit if the element does not exist in the array
if ! array_contains "${pathToFile}" ${arr_file[@]}
then
  echo "File '${pathToFile}' is not staged."
  exit 1
fi
git show :${pathToFile}
